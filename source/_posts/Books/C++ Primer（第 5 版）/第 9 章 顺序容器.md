---
title: 第 9 章 顺序容器
categories:
- Book
- C++ Primer （第 5 版）
---
# 9.2 容器库概览

- 容器赋值相关操作会使指向左边容器内部的迭代器、引用和指针失效。而 `swap` 操作将容器内容交换则不会（`array` 和 `string` 除外）。
- `array` 在模板定义类类型时接受大小参数，在初始化时无法接受。
- `assign` 操作接受起止迭代器或初始化列表或长度初始值以替换元素，`assign` 无法用在 `array` 和关联容器上。
- 除 `array` 外，`swap` 函数仅会交换容器内部数据结构，因此速度很快。但是指针，引用和迭代器会指向 `swap` 对象。而对于 `string`，指针，引用和迭代器会在 `swap` 后失效。对于 `array`，指针，引用和迭代器指向的对象不变，但是值会被 `swap`。

# 9.3 顺序容器操作

- 向容器加入值时，加入的是值的拷贝。容器内无法存放引用。
- 使用 `emplace` 可以将参数直接传递给容器元素类型的构造函数。
- `back`，`front`，`at` 返回引用。
- `at` 可以在下标大小不对时抛出 `out_of_range` 异常。
- 删除 `deque` 中除了首位位置外的任何元素都会使所有迭代器，引用和指针失效。如果在首尾位置添加元素，仅迭代器失效。
- 指向 `vector` 或 `string` 中删除点之后位置的迭代器，引用和指针都会失效。
- `forward_list` 中需要传入删除或添加元素的前一个元素的迭代器，定义了首前迭代器，可以用 `(c)before_begin` 成员函数获取。
- 对于 `vector` 或 `string`，如果发生了存储空间重新分配，那么迭代器，引用和指针会失效。

# 9.4 `vector` 对象是如何增长的
 
- `capacity` 可以获取当前容量。
- `reserve` 可以提示 `vector` 准备至少需要的空间。
- `shrink_to_fit` 提示 `vector` 退回不需要的空间，依赖标准库。

# 9.5 额外的 `string` 操作

- `string` 类型 `replace` 和 `insert` 允许的参数：
  
  |                replace                 |                  replace                   |          insert          |            insert            |                      arguments                      |
  | :------------------------------------: | :----------------------------------------: | :----------------------: | :--------------------------: | :-------------------------------------------------: |
  | `(size_t, size_t, args)`（下标与长度） | `(iterator, iterator, args)`（起止迭代器） | `(size_t, args)`（下标） | `(iterator, args)`（迭代器） |
  |                   是                   |                     是                     |            是            |              否              |                      `string`                       |
  |                   是                   |                     否                     |            是            |              否              | `string, size_t, size_t`（`string` 后接下标与长度） |
  |                   是                   |                     是                     |            是            |              否              |       `const char*, size_t`（字符数组与长度）       |
  |                   是                   |                     是                     |            否            |              否              |              `const char*`（字符数组）              |
  |                   是                   |                     是                     |            是            |              是              |         `size_t, char`（同一字符重复出现）          |
  |                   否                   |                     是                     |            否            |              是              |                `iterator, iterator`                 |
  |                   否                   |                     是                     |            否            |              是              |                     初始化列表                      |

- `string` 搜索操作返回 `string::size_type` 类型，若搜索失败，返回 `string::npos`，该值为 `unsigned`，初始化为 `-1`，因此不应使用 `int` 存储。
- `to_string`：返回算术类型的字符串表示。
- `sto[i/l/ul/ll/ull](s, p, b)`：字符串转换为整数算术类型，`s` 为字符串，`p` 为 `size_t` 指针，存储转换后第一个非数值字符的下标，`b` 为基数。其中 `p`, `b` 有默认值 `0`, `10`。
- `sto[f/d/ld]`：浮点数版本，相比整数算术类型不接受 `b` 参数。